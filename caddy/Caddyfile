{
    admin :2019
    auto_https off
}

:80 {
    # Static file server
    handle /files/* {
        root * /data
        file_server browse {
            precompressed zstd br gzip
        }
    }

    # Auth Service
    handle /auth/* {
        reverse_proxy auth-service:8001
    }

    # GPIO WebSocket and API
    handle /gpio/* {
        reverse_proxy gpio-service:8000
    }

    # Gitea
    handle /git/* {
        reverse_proxy gitea:3000
    }

    # Basic status endpoint
    handle /status {
        respond "OK" 200
    }

    # Catch-all handler
    handle {
        respond "Edge Device API Server" 200
    }

    log {
        output stdout
        format console
        level INFO
    }

    encode zstd gzip
}
